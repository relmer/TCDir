#pragma once





class CFlag
{
public:
    static inline BOOL IsSet    (DWORD dwFlags,   DWORD dwBitsRequired);
    static inline BOOL IsNotSet (DWORD dwFlags,   DWORD dwBitsExcluded);
    static inline void Set      (DWORD & dwFlags, DWORD dwBitsToSet);    
    static inline void Clear    (DWORD & dwFlags, DWORD dwBitsToClear);
};            





////////////////////////////////////////////////////////////////////////////////
//
//  CFlag::IsSet
//
//  
//
////////////////////////////////////////////////////////////////////////////////

BOOL CFlag::IsSet (DWORD dwFlags, DWORD dwBitsRequired)
{
    return (dwFlags & dwBitsRequired) == dwBitsRequired;
}





////////////////////////////////////////////////////////////////////////////////
//
//  CFlag::IsNotSet
//
//  
//
////////////////////////////////////////////////////////////////////////////////

BOOL CFlag::IsNotSet (DWORD dwFlags, DWORD dwBitsExcluded)
{
    return (dwFlags & dwBitsExcluded) == 0;
}





////////////////////////////////////////////////////////////////////////////////
//
//  CFlag::Set
//
//  
//
////////////////////////////////////////////////////////////////////////////////

void CFlag::Set (DWORD & dwFlags, DWORD dwBitsToSet)
{               
    dwFlags |= dwBitsToSet;
}





////////////////////////////////////////////////////////////////////////////////
//
//  CFlag::Clear
//
//  
//
////////////////////////////////////////////////////////////////////////////////

void CFlag::Clear (DWORD & dwFlags, DWORD dwBitsToClear)
{
    dwFlags &= ~dwBitsToClear;
}
